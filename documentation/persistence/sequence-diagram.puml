@startuml
skinparam handwritten true
skinparam monochrome true
skinparam packageStyle rect
skinparam defaultFontName FG Virgil
skinparam shadowing false

participant "{NameofUS}X" as SVC <<application>>
participant PersistenceContext as Persistence <<persistence>>
participant AppSettings as App
participant RepositoryFactory as Factory <<factory>>
database "{NameOfObject}Repository" as Repository <<repository>>

-> SVC :
activate SVC

        SVC -> Persistence: repositories()
        activate Persistence

        Persistence -> App : instance()
        activate App
        Persistence -> App : getRepositoryFactory()
            note right of App: can create repository in memory or JPA
            App -> Factory: create
            App --> Persistence: factory
        deactivate App
            Persistence --> SVC: factory
        deactivate Persistence

        SVC -> Factory: {nameOfObjects}()
        activate Factory
            Factory -> Repository: create
            Factory -> SVC: {nameOfObject}Repository
        deactivate Factory

<-- SVC :
deactivate SVC

@enduml
